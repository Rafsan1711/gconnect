<!DOCTYPE html>
<html lang="bn">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChessAi</title>

  <style>
    /* === Global Reset & Base === */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: #121212;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #e6e6e6;
      display: flex;
      flex-direction: column;
      height: 100vh;
      /* overflow:hidden ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶Ø‡¶æ‡¶§‡ßá input sticky ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá */
    }

    h1 {
      margin: 1rem;
      text-align: center;
      font-weight: 700;
      color: #fff;
      flex: 0 0 auto; /* ‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶´‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏ ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∞‡ßá‡¶ñ‡ßá ‡¶Ø‡¶§‡¶ü‡¶æ ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ ‡¶¶‡ßá‡¶¨‡ßá, ‡¶†‡¶ø‡¶ï ‡¶§‡¶æ‡¶á ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
    }

    /* === Splash Screen Styles === */
    #splash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 3s ease;
    }

    #splash img {
      width: 100%;
      height: 100%;
    }

    #splash.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* === Chat Container === */
    #chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 720px;
      margin: 0 auto;
      border-radius: 8px;
      background: #343541;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
      /* overflow:hidden ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
    }

    /* === Chat Area === */
    #chat-area {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      scroll-behavior: smooth;
      background: #343541;
    }

    .message {
      max-width: 80%;
      line-height: 1.4;
      padding: 12px 16px;
      border-radius: 12px;
      font-size: 1rem;
      white-space: pre-wrap;
      word-break: break-word;
      user-select: text;
    }

    .message.user {
      align-self: flex-end;
      background: linear-gradient(120deg, #4caf50 0%, #43a047 100%);
      color: #fff;
      border-bottom-right-radius: 2px;
    }

    .message.bot {
      align-self: flex-start;
      background: #444654;
      color: #e6e6e6;
      border-bottom-left-radius: 2px;
      font-family: 'Courier New', Courier, monospace;
    }

    /* === Full-width Lichess iframe wrapper === */
    .message.full-board {
      max-width: 100%;
      width: 100%;
      padding: 0;
      background: transparent;
      border-radius: 0;
    }

    /* Typing Animation Container */
    .typing {
      border-right: 2px solid #4caf50;
      animation: blink-caret 1s step-end infinite;
      white-space: pre-wrap;
      overflow-wrap: break-word;
    }

    @keyframes blink-caret {
      0%, 100% {
        border-color: transparent;
      }
      50% {
        border-color: #4caf50;
      }
    }

    /* Link styling */
    .message.bot a {
      color: #4dabf7;
      text-decoration: underline;
      margin-left: 4px;
    }

    /* === Input Area === */
    #input-area {
      display: flex;
      padding: 10px 20px;
      background: #202123;
      border-top: 1px solid #4b5563;
      gap: 10px;
      position: sticky;
      bottom: 0;
      /* ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ü‡¶ü‡¶ï‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
      flex: 0 0 auto;
      /* ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ö‡¶Ç‡¶∂‡¶ï‡ßá ‡¶´‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏ ‡¶ï‡¶∞‡ßá ‡¶â‡¶™‡¶∞‡ßá ‡¶§‡ßÅ‡¶≤‡ßá ‡¶®‡ßá‡¶¨‡ßá */
      z-index: 10;
      /* ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶¨‡ßÅ‡¶¶‡ßç‡¶¨‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶®‡¶æ ‡¶Ø‡¶æ‡ßü */
    }

    #user-input {
      flex: 1;
      border: none;
      padding: 14px 16px;
      font-size: 1rem;
      border-radius: 20px;
      background: #121212;
      color: #e6e6e6;
      outline-offset: 2px;
      outline-color: #4caf50;
      transition: outline-color 0.3s ease;
    }

    #user-input:focus {
      outline-color: #80e27e;
    }

    #send-btn {
      background: #4caf50;
      border: none;
      border-radius: 20px;
      padding: 0 20px;
      font-weight: 700;
      font-size: 1rem;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
      user-select: none;
    }

    #send-btn:hover {
      background: #43a047;
    }

    /* === Chessboard Styles === */
    .chessboard {
      display: grid;
      grid-template-columns: repeat(8, 40px);
      grid-template-rows: repeat(8, 40px);
      gap: 0;
      border: 2px solid #fff;
      margin: 1rem auto;
      width: fit-content;
      box-shadow: 0 0 10px #0af;
    }

    .square {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .light {
      background: #f0d9b5;
    }

    .dark {
      background: #b58863;
    }

    .piece {
      width: 36px;
      height: 36px;
      pointer-events: none;
      user-select: none;
      /* transition: transform 0.3s ease; */
    }

    /* === Responsive Adjustments === */
    @media (max-width: 600px) {
      #chat-container {
        width: 100vw;
        height: 100vh;
        border-radius: 0;
      }

      .chessboard {
        grid-template-columns: repeat(8, 30px);
        grid-template-rows: repeat(8, 30px);
      }

      .square {
        width: 30px;
        height: 30px;
      }

      .piece {
        width: 26px;
        height: 26px;
      }
    }
  </style>
</head>

<body>
  <!-- Splash Screen -->
  <div id="splash">
    <img src="ai.gif" alt="Loading..." />
  </div>

  <h1>ChessAi ü§ñ</h1>
  <div id="chat-container" role="main" aria-label="Chess chatbot application">
    <div id="chat-area" aria-live="polite" aria-atomic="false"></div>
    <div id="input-area">
      <input type="text" id="user-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶¨‡¶æ ‡¶ì‡¶™‡ßá‡¶®‡¶ø‡¶Ç ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‚Ä¶" autocomplete="off" />
      <button id="send-btn">></button>
    </div>
  </div>

  <script>
    (() => {
      "use strict";

      const chatArea = document.getElementById("chat-area");
      const userInput = document.getElementById("user-input");
      const sendBtn = document.getElementById("send-btn");

      // Utility: sleep for ms milliseconds
      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      // Append message to chat
      function appendMessage(text, sender) {
        const messageDiv = document.createElement("div");
        messageDiv.classList.add("message", sender);

        if (sender === "bot") {
          // Typing animation for bot
          typeText(messageDiv, text);
        } else {
          // Instant display for user
          messageDiv.textContent = text;
          chatArea.appendChild(messageDiv);
          chatArea.scrollTop = chatArea.scrollHeight;
        }
      }

      // Typing animation function
      async function typeText(container, text) {
        container.textContent = "";
        container.classList.add("typing");
        chatArea.appendChild(container);
        chatArea.scrollTop = chatArea.scrollHeight;

        for (let i = 0; i < text.length; i++) {
          container.textContent += text.charAt(i);
          chatArea.scrollTop = chatArea.scrollHeight;
          await sleep(20 + Math.random() * 40);
        }
        container.classList.remove("typing");
      }

      /* === 1) Predefined Knowledge Base (Q&A) === */
      const knowledgeBase = [
        {
          questions: ["‡¶¶‡¶æ‡¶¨‡¶æ ‡¶ï‡ßÄ", "what is chess", "chess ‡¶ï‡¶ø"],
          answer: "‡¶¶‡¶æ‡¶¨‡¶æ ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶ú‡¶ø‡¶ï ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶ó‡ßá‡¶Æ ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶™‡¶æ‡¶≤‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ö‡¶æ‡¶≤ ‡¶¶‡ßá‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶∞‡¶æ‡¶ú‡¶æ‡¶ï‡ßá ‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡•§"
        },
        {
          questions: ["‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡¶æ‡¶¨‡¶æ ‡¶ñ‡ßá‡¶≤‡ßá", "how to play chess", "‡¶¶‡¶æ‡¶¨‡¶æ ‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ"],
          answer: "‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßá‡¶ï ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡ßß‡ß¨‡¶ü‡¶ø ‡¶ò‡ßÅ‡¶ü‡¶ø ‡¶•‡¶æ‡¶ï‡ßá‡•§ ‡¶∞‡¶æ‡¶ú‡¶æ, ‡¶∞‡¶æ‡¶®‡ßÄ, ‡¶∞‡ßÅ‡¶ï, ‡¶®‡¶æ‡¶á‡¶ü, ‡¶¨‡¶ø‡¶∂‡¶™ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡¶†‡¶ø‡¶§‡•§ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶π‡¶≤‡ßã ‡¶∞‡¶æ‡¶ú‡¶æ‡¶ï‡ßá ‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡•§"
        },
        {
          questions: ["‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶ï‡¶ø", "what is checkmate", "checkmate ‡¶ï‡¶ø"],
          answer: "‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶π‡¶≤‡ßã ‡¶è‡¶Æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ú‡¶æ ‡¶Ü‡¶ï‡ßç‡¶∞‡¶Æ‡¶£‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶•‡¶æ‡¶ï‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßã‡¶® ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡ßü ‡¶∏‡¶∞‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶®‡¶æ, ‡¶´‡¶≤‡ßá ‡¶ó‡ßá‡¶Æ ‡¶∂‡ßá‡¶∑‡•§"
        },
        {
          questions: ["‡¶ï‡ßá ‡¶¨‡¶æ‡¶®‡¶ø‡ßü‡ßá‡¶õ‡ßá", "creator", "builder", "owner"],
          answer: "‡¶≠‡¶æ‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®! ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶¨‡¶æ‡¶®‡¶ø‡ßü‡ßá‡¶õ‡ßá‡¶® ‡¶∏‡¶æ‡¶Æ‡¶ø‡¶â‡¶≤ ‡¶π‡¶ï ‡¶∞‡¶æ‡¶´‡¶∏‡¶æ‡¶®‡•§ ‡¶§‡¶ø‡¶®‡¶ø ‡¶è‡¶ï‡¶ú‡¶® ‡¶§‡¶∞‡ßÅ‡¶£  ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡¶æ‡¶∞ ‡•§"
        },
        {
          questions: ["‡¶ï‡ßç‡¶Ø‡¶æ‡¶∏‡¶≤‡¶ø‡¶Ç ‡¶ï‡¶ø", "castling ‡¶ï‡¶ø", "castling"],
          answer: "‡¶ï‡ßç‡¶Ø‡¶æ‡¶∏‡¶≤‡¶ø‡¶Ç ‡¶π‡¶≤‡ßã ‡¶è‡¶ï ‡¶ß‡¶∞‡¶®‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ö‡¶æ‡¶≤ ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ú‡¶æ ‡¶ì ‡¶∞‡ßÅ‡¶ï ‡¶è‡¶ï‡¶∏‡¶ô‡ßç‡¶ó‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡ßü ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶®‡¶ø‡ßü‡¶Æ ‡¶Æ‡ßá‡¶®‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶∞‡¶æ‡¶ú‡¶æ‡¶ï‡ßá ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡ßå‡¶∂‡¶≤‡•§"
        },
        {
          questions: ["‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡ßá", "pawn move", "‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶ö‡¶æ‡¶≤"],
          answer: "‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡¶∏‡¶æ‡¶Æ‡¶®‡ßá ‡¶è‡¶ï ‡¶ß‡¶æ‡¶™ ‡¶ö‡¶≤‡ßá, ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ö‡¶æ‡¶≤ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¶‡ßÅ‡¶á ‡¶ß‡¶æ‡¶™ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶°‡¶æ‡ßü‡¶æ‡¶ó‡ßã‡¶®‡¶æ‡¶≤‡¶ø ‡¶™‡¶ø‡¶∏ ‡¶ß‡¶∞‡ßá‡•§"
        },
        {
          questions: ["‡¶∞‡ßÅ‡¶ï ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡ßá", "rook move", "‡¶∞‡ßÅ‡¶ï ‡¶ö‡¶æ‡¶≤"],
          answer: "‡¶∞‡ßÅ‡¶ï ‡¶∏‡¶∞‡¶≤ ‡¶≤‡¶æ‡¶á‡¶®‡ßá (‡¶Ü‡¶°‡¶º‡¶æ‡¶Ü‡¶°‡¶º‡¶ø ‡¶¨‡¶æ ‡¶â‡¶∞‡ßç‡¶ß‡ßç‡¶¨‡¶Æ‡ßÅ‡¶ñ‡ßÄ) ‡¶Ø‡¶§‡¶ü‡¶æ ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá‡•§"
        },
        {
          questions: ["‡¶®‡¶æ‡¶á‡¶ü ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡ßá", "knight move", "‡¶®‡¶æ‡¶á‡¶ü ‡¶ö‡¶æ‡¶≤"],
          answer: "‡¶®‡¶æ‡¶á‡¶ü ‡¶≤-‡¶è‡¶∞ ‡¶Ü‡¶ï‡ßÉ‡¶§‡¶ø‡¶§‡ßá ‡¶ö‡¶≤‡ßá ‚Äî ‡¶¶‡ßÅ‡¶á ‡¶ß‡¶æ‡¶™ ‡¶∏‡¶∞‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶è‡¶ï ‡¶ß‡¶æ‡¶™ ‡¶™‡¶æ‡¶∂ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶ò‡ßÅ‡¶ü‡¶ø ‡¶Ø‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ò‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ì‡¶™‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§"
        },
        {
          questions: ["‡¶¨‡¶ø‡¶∏‡¶™ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡ßá", "bishop move", "‡¶¨‡¶ø‡¶∂‡¶™ ‡¶ö‡¶æ‡¶≤"],
          answer: "‡¶¨‡¶ø‡¶∂‡¶™ ‡¶°‡¶æ‡ßü‡¶æ‡¶ó‡ßã‡¶®‡¶æ‡¶≤‡¶ø ‡¶Ø‡¶§‡¶¶‡ßÇ‡¶∞ ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá‡•§"
        },
        {
          questions: ["‡¶∞‡¶æ‡¶®‡ßÄ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡ßá", "queen move", "‡¶∞‡¶æ‡¶®‡ßÄ ‡¶ö‡¶æ‡¶≤"],
          answer: "‡¶∞‡¶æ‡¶®‡ßÄ ‡¶∏‡¶∞‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶°‡¶æ‡ßü‡¶æ‡¶ó‡ßã‡¶®‡¶æ‡¶≤‡¶ø ‡¶â‡¶≠‡¶Ø‡¶º ‡¶¶‡¶ø‡¶ï‡ßá‡¶á ‡¶ö‡¶≤‡ßá, ‡¶Ø‡¶§‡¶¶‡ßÇ‡¶∞ ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá‡•§"
        },
        {
          questions: ["‡¶ó‡ßá‡¶Æ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º", "how does game end", "‡¶ó‡ßá‡¶Æ ‡¶∂‡ßá‡¶∑"],
          answer: "‡¶ó‡ßá‡¶Æ ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü ‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü, ‡¶∏‡ßç‡¶ü‡ßá‡¶≤‡¶Æ‡ßá‡¶ü, ‡¶°‡ßç‡¶∞, ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º‡ßá ‡¶ó‡ßá‡¶≤‡ßá‡•§"
        },
        {
          questions: ["‡¶∏‡ßç‡¶ü‡ßá‡¶≤‡¶Æ‡ßá‡¶ü ‡¶ï‡¶ø", "what is stalemate", "‡¶∏‡ßç‡¶ü‡ßá‡¶≤‡¶Æ‡ßá‡¶ü"],
          answer: "‡¶∏‡ßç‡¶ü‡ßá‡¶≤‡¶Æ‡ßá‡¶ü ‡¶π‡¶≤‡ßã ‡¶è‡¶Æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶Ø‡¶ñ‡¶® ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ö‡¶æ‡¶≤ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶∞‡¶æ‡¶ú‡¶æ ‡¶ö‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶á, ‡¶´‡¶≤‡ßá ‡¶ó‡ßá‡¶Æ ‡¶°‡ßç‡¶∞ ‡¶π‡ßü‡•§"
        },
        {
          questions: ["‡¶¶‡¶æ‡¶¨‡¶æ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º", "how to start chess", "‡¶¶‡¶æ‡¶¨‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ"],
          answer: "‡¶∏‡¶æ‡¶¶‡¶æ ‡¶ò‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶ö‡¶æ‡¶≤ ‡¶¶‡ßá‡¶Ø‡¶º, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡•§ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡•§"
        },
        {
          questions: ["‡¶¶‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá", "chess turn", "‡¶ü‡¶æ‡¶∞‡ßç‡¶®"],
          answer: "‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞‡¶æ ‡¶™‡¶æ‡¶≤‡¶æ‡¶ï‡ßç‡¶∞‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ö‡¶æ‡¶≤ ‡¶¶‡ßá‡¶Ø‡¶º‡•§ ‡¶∏‡¶æ‡¶¶‡¶æ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ö‡¶æ‡¶≤ ‡¶¶‡ßá‡¶Ø‡¶º, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶ï‡¶æ‡¶≤‡ßã‡•§"
        },
        {
          questions: ["‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶ï‡ßÄ", "what is checkmate", "‡¶ö‡ßá‡¶ï"],
          answer: "‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü (Checkmate) ‡¶π‡¶≤‡ßã ‡¶¶‡¶æ‡¶¨‡¶æ (chess) ‡¶ñ‡ßá‡¶≤‡¶æ‡¶Ø‡¶º ‡¶è‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ, ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶∞‡¶æ‡¶ú‡¶æ (King) ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶ï‡ßç‡¶∞‡¶Æ‡¶£‡ßá‡¶∞ (check) ‡¶Æ‡ßÅ‡¶ñ‡ßá ‡¶•‡¶æ‡¶ï‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßá‡¶á ‡¶Ü‡¶ï‡ßç‡¶∞‡¶Æ‡¶£ ‡¶•‡ßá‡¶ï‡ßá ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡ßà‡¶ß ‡¶ö‡¶æ‡¶≤ (legal move) ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶•‡¶æ‡¶ï‡ßá ‡¶®‡¶æ‡•§ ‡¶è‡¶á ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶Ø‡¶º ‡¶ñ‡ßá‡¶≤‡¶æ‡¶ü‡¶ø ‡¶§‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶æ‡ßé ‡¶∂‡ßá‡¶∑ ‡¶π‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç ‡¶ö‡ßá‡¶ï‡¶Æ‡ßá‡¶ü ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡ßÄ ‡¶π‡¶Ø‡¶º‡•§"
        },
        {
          questions: ["‡¶ï‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá", "what is happening", "‡¶ï‡¶ø"],
          answer: "‡¶Ü‡¶Æ‡¶ø ‡¶¶‡¶æ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶ø‡¶§‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶õ‡¶ø‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶¶‡¶æ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§"
        }
      ];

      function normalizeText(text) {
        return text.toLowerCase().replace(/[^\w\s\u0980-\u09FF]/g, "").trim();
      }

      function getAnswer(input) {
        const normalizedInput = normalizeText(input);
        for (const entry of knowledgeBase) {
          for (const q of entry.questions) {
            const normQ = normalizeText(q);
            if (normalizedInput.includes(normQ)) {
              return entry.answer;
            }
          }
        }
        return null;
      }

      /* === 2) Chess Openings Logic === */
      const openings = {
        "Italian Opening": ["e2e4", "e7e5", "g1f3", "b8c6", "f1c4", "g8f6", "f3g5", "f8c5", "g5f7", "d8e7", "f7h8"],
        "Scandinavian Defense": ["e2e4", "d7d5"],
        "Queen's gambit": ["d2d4", "d7d5", "c2c4", "e7e6", "b1c3", "g8f6"],
        "qg accepted": ["d2d4", "d7d5", "c2c4", "d5c4", "g1f3", "g8f6", "e2e3", "e7e6", "f1c4"],
        "Sicilian Defense": ["e2e4", "c7c5"],
        "Caro-Kann Defense": ["e2e4", "c7c6", "d2d4", "d7d5"],
        "French Defense": ["e2e4", "e7e6", "d2d4", "d7d5"],
        "Pirc Defense": ["e2e4", "d7d6", "d2d4", "g8f6"],
        "King's Indian Defense": ["d2d4", "g8f6", "c2c4", "g7g6", "b1c3", "f8g7"],
        "Grunfeld Defense": ["d2d4", "g8f6", "c2c4", "g7g6", "b1c3", "d7d5"],
        "Nimzo-Indian Defense": ["d2d4", "g8f6", "c2c4", "e7e6", "b1c3", "f8b4"],
        "Slav Defense": ["d2d4", "d7d5", "c2c4", "c7c6"],
        "Queen's Gambit Declined": ["d2d4", "d7d5", "c2c4", "e7e6"],
        "Semi-Slav Defense": ["d2d4", "d7d5", "c2c4", "c7c6", "b1c3", "e7e6"],
        "Benoni Defense": ["d2d4", "g8f6", "c2c4", "c7c5", "d4d5", "e7e6"],
        "Benko Gambit": ["d2d4", "g8f6", "c2c4", "c7c5", "d4d5", "b7b5"],
        "Modern Defense": ["e2e4", "g7g6"],
        "Philidor Defense": ["e2e4", "e7e5", "g1f3", "d7d6"],
        "Petrov's Defense": ["e2e4", "e7e5", "g1f3", "g8f6"],
        "Alekhine's Defense": ["e2e4", "g8f6"],
        "English Opening": ["c2c4"],
        "King's Gambit": ["e2e4", "e7e5", "f2f4"],
        "Evans Gambit": ["e2e4", "e7e5", "g1f3", "b8c6", "f1c4", "f8c5", "b2b4"],
        "Scotch Game": ["e2e4", "e7e5", "g1f3", "b8c6", "d2d4"],
        "Vienna Game": ["e2e4", "e7e5", "b1c3"],
        "London System": ["d2d4", "d7d5", "g1f3", "g8f6", "c1f4"],
        "Torre Attack": ["d2d4", "d7d5", "g1f3", "g8f6", "b1d2", "f8g4"],
        "Catalan Opening": ["d2d4", "g8f6", "c2c4", "e7e6", "g2g3"],
        "Reti Opening": ["g1f3", "d7d5", "c2c4"],
        "Bird's Opening": ["f2f4"],
        "Sokolsky Opening": ["b2b4"],
        "Colle System": ["d2d4", "d7d5", "c2c3"],
        "Stonewall Attack": ["d2d4", "d7d5", "c2c3", "e7e6", "f2f4"],
        "Blackmar-Diemer Gambit": ["d2d4", "d7d5", "e2e4"],
        "Albin Countergambit": ["d2d4", "d7d5", "c2c4", "e7e5"],
        "Budapest Gambit": ["d2d4", "g8f6", "c2c4", "e7e5"],
        "Old Indian Defense": ["d2d4", "g8f6", "c2c4", "d7d6"],
        "King's Indian Attack": ["e2e4", "c7c5", "d2d3", "g1f3", "g2g3", "f1g2", "e1g1"],
        "Nimzowitsch Defense": ["e2e4", "d7d6", "d2d4", "b8c6"],
        "Latvian Gambit": ["e2e4", "e7e5", "g1f3", "f7f5"],
        "Chigorin Defense": ["d2d4", "d7d5", "c2c4", "g8f6", "b1c3", "f6e4"],
        "Dutch Defense": ["d2d4", "f7f5"],
        "Queen's Indian Defense": ["d2d4", "g8f6", "c2c4", "e7e6", "g1f3", "b7b6"],
        "Larsen's Opening": ["b2b3"],
        "Zukertort Opening": ["b1c3"],
        "Van't Kruijs Opening": ["e2e3"],
        "Dunst Opening": ["c2c3"],
        "Barnes Opening": ["f2f3"],
        "Grob's Attack": ["g2g4"],
        "King's Fianchetto Opening": ["g2g3"],
        "Ruy Lopez": ["e2e4", "e7e5", "g1f3", "b8c6", "f1b5"]
      };

      const initialPosition = {
        a1: "wR", b1: "wN", c1: "wB", d1: "wQ", e1: "wK", f1: "wB", g1: "wN", h1: "wR",
        a2: "wP", b2: "wP", c2: "wP", d2: "wP", e2: "wP", f2: "wP", g2: "wP", h2: "wP",
        a7: "bP", b7: "bP", c7: "bP", d7: "bP", e7: "bP", f7: "bP", g7: "bP", h7: "bP",
        a8: "bR", b8: "bN", c8: "bB", d8: "bQ", e8: "bK", f8: "bB", g8: "bN", h8: "bR"
      };

      function getPieceURL(pieceCode) {
        const baseURL = "https://raw.githubusercontent.com/lichess-org/lila/master/public/piece/cburnett/";
        return baseURL + pieceCode + ".svg";
      }

      /* === 3) AnimateMoves: ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶¨‡ßá === */
      async function animateMoves(moves) {
        // ‡ßß) ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø
        const board = document.createElement("div");
        board.className = "chessboard";

        // ‡ß®) ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶∏‡ßç‡¶ï‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶§‡ßà‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™
        const squareMap = {};
        for (let rank = 8; rank >= 1; rank--) {
          for (let file = 0; file < 8; file++) {
            const squareDiv = document.createElement("div");
            const isLight = (rank + file) % 2 === 0;
            squareDiv.className = `square ${isLight ? "light" : "dark"}`;
            const coord = "abcdefgh"[file] + rank;
            squareDiv.dataset.square = coord;
            board.appendChild(squareDiv);
            squareMap[coord] = squareDiv;
          }
        }

        // ‡ß©) ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡¶ü‡¶ø‡¶ï‡ßá ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá ‡¶ú‡ßÅ‡¶°‡¶º‡ßá ‡¶¶‡¶ø‡¶®
        chatArea.appendChild(board);
        chatArea.scrollTop = chatArea.scrollHeight;

        // ‡ß™) ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶Ø‡¶º ‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶∏‡¶¨ ‡¶™‡¶ø‡¶∏ ‡¶¨‡¶∏‡¶æ‡¶®
        let pos = { ...initialPosition };
        for (const sq in pos) {
          const img = document.createElement("img");
          img.className = "piece";
          img.src = getPieceURL(pos[sq]);
          squareMap[sq].appendChild(img);
        }

        // ‡ß´) ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶ö‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        for (const move of moves) {
          await sleep(700);
          const from = move.slice(0, 2);
          const to = move.slice(2);

          if (pos[from]) {
            pos[to] = pos[from];
            delete pos[from];
          }

          // ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∏‡ßç‡¶ï‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶ø‡¶∏ ‡¶¨‡¶∏‡¶æ‡¶®
          for (const coord in squareMap) {
            squareMap[coord].innerHTML = "";
          }
          for (const sq in pos) {
            const img = document.createElement("img");
            img.className = "piece";
            img.src = getPieceURL(pos[sq]);
            squareMap[sq].appendChild(img);
          }
        }
      }

      /* === 4) Main Input Handler === */
      async function handleInput() {
        const text = userInput.value.trim();
        if (!text) return;

        // Disable inputs while processing
        userInput.disabled = true;
        sendBtn.disabled = true;

        // Display user's message
        const userMsg = document.createElement("div");
        userMsg.classList.add("message", "user");
        userMsg.textContent = text;
        chatArea.appendChild(userMsg);
        chatArea.scrollTop = chatArea.scrollHeight;
        userInput.value = "";

        await sleep(200);

        // === 4.1) ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ "lichess" ‡¶≤‡¶ø‡¶ñ‡ßá ===
        const normalized = text.toLowerCase().replace(/\s+/g, "");
        if (normalized.includes("board")) {
          // ‡¶¨‡¶°‡¶º ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ iframe ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø wrapper-‡¶è ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ "full-board" ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
          const wrapper = document.createElement("div");
          wrapper.classList.add("message", "bot", "full-board");

          const iframe = document.createElement("iframe");
          iframe.src = "https://lichess.org/embed/analysis";
          iframe.width = "100%";
          iframe.height = "1000vh";
          iframe.style.border = "none";
          iframe.allowFullscreen = true;
          iframe.loading = "lazy";

          wrapper.appendChild(iframe);
          chatArea.appendChild(wrapper);
          chatArea.scrollTop = chatArea.scrollHeight;

          userInput.disabled = false;
          sendBtn.disabled = false;
          userInput.focus();
          return;
        }

        // === 4.2) Check predefined QA ===
        const qaAnswer = getAnswer(text);
        if (qaAnswer) {
          appendMessage(qaAnswer, "bot");
          userInput.disabled = false;
          sendBtn.disabled = false;
          userInput.focus();
          return;
        }

        // === 4.3) Check openings (English names) ===
        const matchedOpening = Object.keys(openings).find(name =>
          text.toLowerCase().includes(name.toLowerCase())
        );
        if (matchedOpening) {
          appendMessage(
            `‡¶è‡¶ü‡¶ø '${matchedOpening}' ‡¶ì‡¶™‡ßá‡¶®‡¶ø‡¶Ç-‡¶è‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Æ; ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§`,
            "bot"
          );
          await sleep(300);
          animateMoves(openings[matchedOpening]);
          userInput.disabled = false;
          sendBtn.disabled = false;
          userInput.focus();
          return;
        }

        // === 4.4) Fallback response ===
        appendMessage(
          "‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶¨‡¶æ ‡¶ì‡¶™‡ßá‡¶®‡¶ø‡¶Ç ‡¶ö‡¶ø‡¶®‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡¶®‡¶ø‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶¶‡¶æ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø‡¶§‡ßá ‡¶ì‡¶™‡ßá‡¶®‡¶ø‡¶Ç ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® ‡¶Ø‡ßá‡¶Æ‡¶® 'Italian Opening'‡•§",
          "bot"
        );
        userInput.disabled = false;
        sendBtn.disabled = false;
        userInput.focus();
      }

      // Event listeners
      sendBtn.addEventListener("click", handleInput);
      userInput.addEventListener("keydown", e => {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          handleInput();
        }
      });

      // Initial welcome message with typing animation + FAQ link appended after typing
      document.addEventListener("DOMContentLoaded", async () => {
        userInput.focus();

        // ‡ßß. Create container for first bot message
        const firstContainer = document.createElement("div");
        firstContainer.classList.add("message", "bot");
        chatArea.appendChild(firstContainer);
        chatArea.scrollTop = chatArea.scrollHeight;

        // ‡ß®. Type out the text portion (without link)
        const initialText =
          "‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ! ‡¶¶‡¶æ‡¶¨‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®, ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø‡¶§‡ßá ‡¶ì‡¶™‡ßá‡¶®‡¶ø‡¶Ç ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® ‡¶Ø‡ßá‡¶Æ‡¶® 'Italian Opening', 'Ruy Lopez', 'Scandinavian Defense', ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡ßá‡¶ï‡¶ü‡¶æ Opening ‡¶è‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶®‡¶æ‡¶Æ accurate  ‡¶≤‡¶ø‡¶ñ‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§‡¶Ø‡¶¶‡¶ø Analysis board ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶ö‡¶æ‡¶® ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßÄ‡ßü ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßá‡¶§‡ßá ";
        await typeText(firstContainer, initialText);

        // ‡ß©. Append the clickable FAQ link
        const faqLink = document.createElement("a");
        faqLink.href = "faq.html";
        faqLink.target = "_blank";
        faqLink.textContent = "FAQ";
        firstContainer.appendChild(faqLink);

        chatArea.scrollTop = chatArea.scrollHeight;
      });
    })();

    // Splash screen fade-out logic
    window.addEventListener("load", () => {
      const splash = document.getElementById("splash");
      setTimeout(() => {
        splash.classList.add("hidden");
      }, 4000); // 4 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶π‡¶æ‡¶≤‡¶ï‡¶æ fade-out ‡¶π‡¶¨‡ßá
    });
  </script>
</body>

</html>